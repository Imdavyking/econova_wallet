<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      //wait for 5 seconds
      setTimeout(async () => {
        const myTypedData = {
          types: {
            StarkNetDomain: [
              { name: "name", type: "felt" },
              { name: "version", type: "felt" },
              { name: "chainId", type: "felt" },
            ],
            Airdrop: [
              { name: "address", type: "felt" },
              { name: "amount", type: "felt" },
            ],
            Validate: [
              { name: "id", type: "felt" },
              { name: "from", type: "felt" },
              { name: "amount", type: "felt" },
              { name: "nameGamer", type: "felt" },
              { name: "endDate", type: "felt" },
              { name: "itemsAuthorized", type: "felt*" }, // array of felts
              { name: "chkFunction", type: "felt" }, // function selector as felt
              { name: "rootList", type: "Airdrop*" }, // array of Airdrop structs
            ],
          },
          primaryType: "Validate",
          domain: {
            name: "myDapp",
            version: "1",
            chainId: "0x534e5f5345504f4c4941", // must be a felt string
          },
          message: {
            id: "0x0000004f000f",
            from: "0x2c94f628d125cd0e86eaefea735ba24c262b9a441728f63e5776661829a4066",
            amount:
              "0x69b49c2cc8b16e80e86bfc5b0614a59aa8c9b601569c7b80dde04d3f3151b79",
            nameGamer: "0x486563746f723236", // "Hector26" as hex string
            endDate:
              "0x27d32a3033df4277caa9e9396100b7ca8c66a4ef8ea5f6765b91a7c17f0109c",
            itemsAuthorized: [
              "0x27d32a3033df4277caa9e9396100b7ca8c66a4ef8ea5f6765b91a7c17f0109c",
              "0x69b49c2cc8b16e80e86bfc5b0614a59aa8c9b601569c7b80dde04d3f3151b79",
              "0x27d32a3033df4277caa9e9396100b7ca8c66a4ef8ea5f6765b91a7c17f0109c",
              "0x27d32a3033df4277caa9e9396100b7ca8c66a4ef8ea5f6765b91a7c17f0109c",
            ],
            chkFunction: "0x636865636b5f617574686f72697a6174696f6e", // "check_authorization" as hex
            rootList: [
              {
                address:
                  "0x69b49c2cc8b16e80e86bfc5b0614a59aa8c9b601569c7b80dde04d3f3151b79",
                amount: "0x636865636b5f617574686f72697a6174696f6e",
              },
            ],
          },
        };
        // 889530405614654528368682349570425617807964042527703311146510106249998149218;
        // 889530405614654528368682349570425617807964042527703311146510106249998149218
        // 889530405614654528368682349570425617807964042527703311146510106249998149218
        // 889530405614654528368682349570425617807964042527703311146510106249998149218

        const accounts = await window.starknet.request({
          type: "wallet_requestAccounts",
        });
        console.log(accounts);
        try {
          const res = await window.starknet.request({
            type: "wallet_signTypedData",
            params: myTypedData,
          }); // error here

          console.log(res);
        } catch (error) {
          console.log("error", error);
        }

        // const deployData = await window.starknet.request({
        //   type: "wallet_deploymentData",
        // });
        // console.log(deployData);

        // ['708430212362690578481737385168447582349670715079420394525131553001725572698', '1397272340006992913981501630459872567993254742548111796371322808616951954156']
      }, 5000);
    </script>
  </body>
</html>

<!-- interface AddDeclareTransactionParameters {
  compiled_class_hash: string // The hash of the Cairo assembly resulting from the Sierra compilation
  contract_class: {
    sierra_program: string[] // The list of Sierra instructions of which the program consists
    contract_class_version: string // The version of the contract class object. Currently, the Starknet OS supports version "0.1.0"
    entry_points_by_type: {
      // Entry points by type
      CONSTRUCTOR: SIERRA_ENTRY_POINT[]
      EXTERNAL: SIERRA_ENTRY_POINT[]
      L1_HANDLER: SIERRA_ENTRY_POINT[]
    }
    abi: string // The stringified class ABI, as supplied by the user declaring the class
  }
  class_hash?: string
}
type SIERRA_ENTRY_POINT = {
  selector: string // selector of the function name = selector.getSelectorFromName(funcName: string);
  function_idx: number
} -->

<!-- response: interface AddDeclareTransactionResult {
  transaction_hash: string // The hash of the declare transaction
  class_hash: string // The hash of the declared class
} -->

<!-- onst myParams: AddDeclareTransactionParameters = {
  compiled_class_hash: hash.computeCompiledClassHash(contractCasm),
  contract_class: {
    sierra_program: contractSierra.sierra_program,
    contract_class_version: "0x01",
    entry_points_by_type: contractSierra.entry_points_by_type,
    abi: json.stringify(contractSierra.abi),
  },
}
const resp = await myWallet.request({
  type: "wallet_addDeclareTransaction",
  params: myParams,
})
// resp = {transaction_hash: "0x067f5a62ec72010308cee6368a8488c8df74f1d375b989f96d48cde1c88c7929", class_hash: "0x2bfd9564754d9b4a326da62b2f22b8fea7bbeffd62da4fcaea986c323b7aeb"} -->
